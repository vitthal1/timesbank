(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{6117:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return t(4423)}])},4423:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ey}});var a=t(5893),r=t(645),l=t.n(r),i=t(7294),n=t(39),d=t(437),c=t(5412),o=t(2217),x=t(116),m=t(6611),u=t(9176),h=t(88),g=t(3488),b=t(4235),p=t(893),f=t(3416),j=t(6428),y=t(2171),N=t(775),v=t(6781),w=t(1163);function _(e){let{children:s}=e,{user:t,loading:r}=(0,v.a)(),l=(0,w.useRouter)();return((0,i.useEffect)(()=>{r||t||l.push("/auth/login")},[t,r,l]),r)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):(0,a.jsx)(a.Fragment,{children:s})}var k=t(9263),C=t(4976),S=t(9810);function Z(e){let{userId:s}=e,[t,r]=(0,i.useState)(0),[l,c]=(0,i.useState)(0),[o,x]=(0,i.useState)(0),[m,u]=(0,i.useState)(!0),[h,g]=(0,i.useState)(!1),b=async()=>{try{let{data:e,error:t}=await k.O.from("users").select("time_balance, total_hours_given, total_hours_received").eq("id",s).single();if(t){console.error("Error fetching user balance:",t);return}e&&(r(e.time_balance||0),c(e.total_hours_given||0),x(e.total_hours_received||0));let{data:a}=await k.O.from("time_ledger").select("hours").eq("from_user",s),{data:l}=await k.O.from("time_ledger").select("hours").eq("to_user",s);null==a||a.reduce((e,s)=>e+Number(s.hours),0),null==l||l.reduce((e,s)=>e+Number(s.hours),0)}catch(e){console.error("Error fetching balance:",e)}finally{u(!1),g(!1)}};(0,i.useEffect)(()=>{b();let e=k.O.channel("user-balance-".concat(s)).on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:"id=eq.".concat(s)},e=>{e.new&&(r(e.new.time_balance||0),c(e.new.total_hours_given||0),x(e.new.total_hours_received||0))}).subscribe();return()=>{e.unsubscribe()}},[s]);let p=t>=0,f=0===t;return(0,a.jsxs)("div",{className:"relative overflow-hidden bg-gradient-to-br from-purple-500 via-purple-600 to-pink-600 rounded-2xl shadow-2xl p-6 text-white",children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-32 h-32 bg-white/10 rounded-full blur-2xl"}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 -mb-4 -ml-4 w-24 h-24 bg-white/10 rounded-full blur-2xl"}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-white/20 p-3 rounded-xl backdrop-blur-sm",children:(0,a.jsx)(n.Z,{className:"w-6 h-6"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Time Balance"})]}),(0,a.jsx)("button",{onClick:()=>{g(!0),b()},disabled:h,className:"bg-white/20 hover:bg-white/30 p-2 rounded-lg backdrop-blur-sm transition-all disabled:opacity-50",title:"Refresh balance",children:(0,a.jsx)(C.Z,{className:"w-5 h-5 ".concat(h?"animate-spin":"")})})]}),m?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-baseline space-x-2",children:[(0,a.jsx)("span",{className:"text-5xl font-bold",children:Math.abs(t)}),(0,a.jsx)("span",{className:"text-xl font-medium opacity-90",children:"hours"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-3",children:f?(0,a.jsxs)("div",{className:"flex items-center space-x-1 bg-white/20 px-3 py-1 rounded-full text-sm backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-white rounded-full"}),(0,a.jsx)("span",{children:"Balanced"})]}):p?(0,a.jsxs)("div",{className:"flex items-center space-x-1 bg-green-400/30 px-3 py-1 rounded-full text-sm backdrop-blur-sm",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Credit"})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-1 bg-orange-400/30 px-3 py-1 rounded-full text-sm backdrop-blur-sm",children:[(0,a.jsx)(S.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Debt"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 text-green-300"}),(0,a.jsx)("p",{className:"text-sm font-medium opacity-90",children:"Received"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:o}),(0,a.jsx)("p",{className:"text-xs opacity-75 mt-1",children:"hours"})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(S.Z,{className:"w-4 h-4 text-orange-300"}),(0,a.jsx)("p",{className:"text-sm font-medium opacity-90",children:"Given"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:l}),(0,a.jsx)("p",{className:"text-xs opacity-75 mt-1",children:"hours"})]})]}),(0,a.jsxs)("p",{className:"text-xs opacity-75 mt-4 text-center",children:[p&&!f&&"You have time credits to use",!p&&"Contribute time to earn credits",f&&"Your time is perfectly balanced"]})]})]})]})}function A(e){let{userId:s}=e,[t,r]=(0,i.useState)(""),[l,n]=(0,i.useState)(0),[d,c]=(0,i.useState)(""),o=async()=>{let{data:e}=await k.O.from("users").select("id").eq("email",t).single();if(!e)return alert("User not found");let{error:a}=await k.O.from("time_ledger").insert([{from_user:s,to_user:e.id,hours:l,note:d}]);a?alert(a.message):alert("Transfer successful")};return(0,a.jsxs)("div",{className:"p-4 bg-white shadow rounded",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Transfer Time"}),(0,a.jsx)("input",{type:"email",placeholder:"Recipient Email",value:t,onChange:e=>r(e.target.value),className:"w-full border p-2 mb-2 rounded"}),(0,a.jsx)("input",{type:"number",placeholder:"Hours",value:l,onChange:e=>n(Number(e.target.value)),className:"w-full border p-2 mb-2 rounded"}),(0,a.jsx)("input",{type:"text",placeholder:"Note",value:d,onChange:e=>c(e.target.value),className:"w-full border p-2 mb-2 rounded"}),(0,a.jsx)("button",{onClick:o,className:"w-full bg-green-500 text-white py-2 rounded",children:"Transfer"})]})}function D(e){let{userId:s}=e,[t,r]=(0,i.useState)([]),l=async()=>{let{data:e}=await k.O.from("time_ledger").select("*").or("from_user.eq.".concat(s,",to_user.eq.").concat(s)).order("created_at",{ascending:!1});r(e||[])};return(0,i.useEffect)(()=>{l();let e=k.O.channel("time_ledger_changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"time_ledger"},e=>{(e.new.from_user===s||e.new.to_user===s)&&r(s=>[e.new,...s])}).subscribe();return()=>{k.O.removeChannel(e)}},[s]),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Transaction History"}),(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:t.map(e=>(0,a.jsxs)("li",{className:"py-2",children:[e.from_user===s?"Sent":"Received"," ",e.hours," hrs - ",e.note]},e.id))})]})}let O=async()=>{let{data:e,error:s}=await k.O.from("skills").select("*");if(s)throw s;return e},F=async e=>{let{data:s,error:t}=await k.O.from("user_skills").select("skill:skill_id(name)").eq("user_id",e);if(t)throw t;return s.map(e=>e.skill)},E=async(e,s)=>{let{data:t,error:a}=await k.O.from("user_skills").insert([{user_id:e,skill_id:s}]);if(a)throw a;return t},q=async(e,s)=>{let{data:t,error:a}=await k.O.from("user_skills").delete().eq("user_id",e).eq("skill_id",s);if(a)throw a;return t},T=e=>{let{userId:s}=e,[t,r]=(0,i.useState)([]),[l,n]=(0,i.useState)([]),[d,c]=(0,i.useState)(""),[o,x]=(0,i.useState)(!1),[m,u]=(0,i.useState)("");(0,i.useEffect)(()=>{!async function(){r(await O()),n(await F(s))}()},[s]);let h=async e=>{try{if(l.find(s=>s.id===e))await q(s,e),n(s=>s.filter(s=>s.id!==e));else{await E(s,e);let a=t.find(s=>s.id===e);a&&n(e=>[...e,a])}u("")}catch(e){u("Failed to update skill")}},g=async()=>{let e=d.trim();if(!e){u("Please enter a skill name");return}let a=t.find(s=>s.name.toLowerCase()===e.toLowerCase());if(a){l.find(e=>e.id===a.id)||await h(a.id),c(""),x(!1),u("");return}try{let{data:t,error:a}=await k.O.from("skills").insert([{name:e}]).select().single();if(a)throw a;r(e=>[...e,t]),await E(s,t.id),n(e=>[...e,t]),c(""),x(!1),u("")}catch(e){u("Failed to add new skill")}};return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Your Skills"}),!o&&(0,a.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>x(!0),children:"+ Add Skill"})]}),m&&(0,a.jsx)("div",{className:"mb-3 p-2 bg-red-100 text-red-700 rounded",children:m}),o&&(0,a.jsxs)("div",{className:"mb-4 flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"===e.key?g():"Escape"===e.key&&(x(!1),c(""),u(""))},placeholder:"Enter skill name",className:"flex-1 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),(0,a.jsx)("button",{onClick:g,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Add"}),(0,a.jsx)("button",{onClick:()=>{x(!1),c(""),u("")},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>(0,a.jsx)("button",{className:"px-3 py-1 rounded transition-colors ".concat(l.find(s=>s.id===e.id)?"bg-green-500 text-white hover:bg-green-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"),onClick:()=>h(e.id),children:e.name},e.id))})]})},U=async e=>{let{data:s,error:t}=await k.O.from("users").select("*").eq("id",e).single();if(t)throw t;return s},P=async(e,s)=>{let{data:t,error:a}=await k.O.from("users").update(s).eq("id",e).select();if(a)throw a;return t};function L(e){let{userId:s}=e,[t,r]=(0,i.useState)(null),[l,n]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!0),[o,x]=(0,i.useState)(!1),[m,u]=(0,i.useState)(""),[h,g]=(0,i.useState)(""),[b,p]=(0,i.useState)({username:"",email:"",bio:"",avatar_url:""});(0,i.useEffect)(()=>{f()},[s]);let f=async()=>{try{c(!0);let e=await U(s);e&&(r(e),p({username:e.username||"",email:e.email||"",bio:e.bio||"",avatar_url:e.avatar_url||""}))}catch(e){u("Failed to load user profile")}finally{c(!1)}},j=e=>{let{name:s,value:t}=e.target;p(e=>({...e,[s]:t}))},y=async e=>{e.preventDefault(),u(""),g(""),x(!0);try{await P(s,{username:b.username,bio:b.bio,avatar_url:b.avatar_url}),await f(),g("Profile updated successfully!"),n(!1),setTimeout(()=>g(""),3e3)}catch(e){u("Failed to update profile. Please try again.")}finally{x(!1)}};return d?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"h-10 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-10 bg-gray-200 rounded"})]})}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Profile Information"}),!l&&(0,a.jsx)("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Edit Profile"})]}),m&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:m}),h&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:h}),(0,a.jsx)("form",{onSubmit:y,children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Avatar"}),l?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[b.avatar_url&&(0,a.jsx)("img",{src:b.avatar_url,alt:"Avatar preview",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-300"}),!b.avatar_url&&(0,a.jsx)("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl text-gray-400",children:"\uD83D\uDC64"})})]}),(0,a.jsx)("input",{type:"url",name:"avatar_url",value:b.avatar_url,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/avatar.jpg"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Enter a URL to your avatar image"})]}):(0,a.jsx)("div",{className:"flex items-center gap-4",children:(null==t?void 0:t.avatar_url)?(0,a.jsx)("img",{src:t.avatar_url,alt:"User avatar",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-300"}):(0,a.jsx)("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl text-gray-400",children:"\uD83D\uDC64"})})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),l?(0,a.jsx)("input",{type:"text",name:"username",value:b.username,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}):(0,a.jsx)("p",{className:"text-gray-900 py-2",children:(null==t?void 0:t.username)||"Not set"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,a.jsx)("p",{className:"text-gray-900 py-2",children:null==t?void 0:t.email}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),l?(0,a.jsx)("textarea",{name:"bio",value:b.bio,onChange:j,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tell us about yourself..."}):(0,a.jsx)("p",{className:"text-gray-900 py-2 whitespace-pre-wrap",children:(null==t?void 0:t.bio)||"Not set"})]}),l&&(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",disabled:o,className:"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:o?"Saving...":"Save Changes"}),(0,a.jsx)("button",{type:"button",onClick:()=>{t&&p({username:t.username||"",email:t.email||"",bio:t.bio||"",avatar_url:t.avatar_url||""}),n(!1),u("")},disabled:o,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors disabled:cursor-not-allowed",children:"Cancel"})]})]})}),(0,a.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Information"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"User ID:"}),(0,a.jsx)("span",{className:"text-gray-900 font-mono text-xs",children:null==t?void 0:t.id})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Account Created:"}),(0,a.jsx)("span",{className:"text-gray-900",children:(null==t?void 0:t.created_at)?new Date(t.created_at).toLocaleDateString():"Unknown"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Account Type:"}),(0,a.jsx)("span",{className:"font-medium ".concat((null==t?void 0:t.is_admin)?"text-purple-600":"text-gray-900"),children:(null==t?void 0:t.is_admin)?"Admin":"Member"})]})]})]})]})})}var R=t(2126),M=t(3832),I=t(5928),B=t(3279),z=t.n(B);let Q=e=>{let s=0;return{score:s=[e.length>=8,/[A-Z]/.test(e),/[a-z]/.test(e),/[0-9]/.test(e),/[!@#$%^&*(),.?":{}|<>]/.test(e)].filter(Boolean).length,label:["Weak","Fair","Good","Strong","Very Strong"][s]||"Weak"}};function H(){let[e,s]=(0,i.useState)(""),[t,r]=(0,i.useState)(""),[l,n]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!1),[o,x]=(0,i.useState)(!1),[m,u]=(0,i.useState)(""),[h,g]=(0,i.useState)(""),[b,p]=(0,i.useState)({score:0,label:"Weak"}),{updatePassword:j}=(0,v.a)(),y=(0,i.useCallback)(z()(e=>{e&&p(Q(e))},300),[]),N=()=>e&&t?e!==t?"New passwords do not match":e.length<6?"New password must be at least 6 characters":b.score<2?"Password is too weak. Please make it stronger.":null:"All fields are required",w=async s=>{s.preventDefault();let t=N();if(u(t||""),g(""),!t){x(!0);try{let s=await j(e);s.success?(g("Password changed successfully!"),_(),setTimeout(()=>g(""),3e3)):u(s.error||"Failed to change password")}catch(e){u("An unexpected error occurred. Please try again.")}finally{x(!1)}}},_=()=>{s(""),r(""),u(""),g(""),p({score:0,label:"Weak"}),n(!1),c(!1)};return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow",role:"region","aria-labelledby":"change-password-heading",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center","aria-hidden":"true",children:(0,a.jsx)(f.Z,{className:"w-6 h-6 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{id:"change-password-heading",className:"text-2xl font-bold text-gray-900",children:"Change Password"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Update your password to keep your account secure"})]})]}),m&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg flex items-start gap-2",role:"alert","aria-live":"polite",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,a.jsx)("span",{children:m})]}),h&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg flex items-start gap-2",role:"alert","aria-live":"polite",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,a.jsx)("span",{children:h})]}),(0,a.jsx)("form",{onSubmit:w,noValidate:!0,"aria-describedby":"password-tips",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(R.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400","aria-hidden":"true"}),(0,a.jsx)("input",{id:"new-password",type:l?"text":"password",value:e,onChange:e=>{let t=e.target.value;s(t),y(t),m.includes("password")&&u("")},className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition disabled:bg-gray-50",placeholder:"Enter new password",required:!0,disabled:o,"aria-describedby":"new-password-strength"}),(0,a.jsx)("button",{type:"button",onClick:()=>n(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition disabled:opacity-50",disabled:o,"aria-label":l?"Hide new password":"Show new password",children:l?(0,a.jsx)(M.Z,{className:"w-5 h-5"}):(0,a.jsx)(I.Z,{className:"w-5 h-5"})})]}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",id:"new-password-strength",children:"Must be at least 6 characters"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(R.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400","aria-hidden":"true"}),(0,a.jsx)("input",{id:"confirm-password",type:d?"text":"password",value:t,onChange:e=>{r(e.target.value),"New passwords do not match"===m&&u("")},className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition disabled:bg-gray-50",placeholder:"Confirm new password",required:!0,disabled:o}),(0,a.jsx)("button",{type:"button",onClick:()=>c(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition disabled:opacity-50",disabled:o,"aria-label":d?"Hide confirm password":"Show confirm password",children:d?(0,a.jsx)(M.Z,{className:"w-5 h-5"}):(0,a.jsx)(I.Z,{className:"w-5 h-5"})})]})]}),e&&(0,a.jsxs)("div",{className:"space-y-2",id:"password-strength-indicator",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Password Strength:"}),(0,a.jsx)("div",{className:"flex gap-1",role:"img","aria-label":"Password strength: ".concat(b.label),children:Array.from({length:5},(e,s)=>(0,a.jsx)("div",{className:"h-2 flex-1 rounded transition-colors ".concat(s<b.score?"bg-green-500":"bg-gray-200"),"aria-hidden":"true"},s))}),(0,a.jsxs)("p",{className:"text-xs font-medium ".concat(b.score>=3?"text-green-600":"text-gray-500"),"aria-live":"polite",children:[b.label," ",b.score<3&&"- Improve for better security"]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",disabled:o||!!m,className:"flex-1 bg-purple-600 text-white font-semibold py-3 rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Update password",children:o?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin","aria-hidden":"true"}),"Updating..."]}):"Update Password"}),(0,a.jsx)("button",{type:"button",onClick:_,disabled:o,className:"px-6 py-3 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Reset form",children:"Reset"})]})]})}),(0,a.jsxs)("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg",id:"password-tips",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Password Security Tips"}),(0,a.jsxs)("ul",{className:"text-xs text-blue-800 space-y-1",role:"list",children:[(0,a.jsx)("li",{children:"• Use at least 8 characters with a mix of letters, numbers, and symbols"}),(0,a.jsx)("li",{children:"• Don't use common words or personal information"}),(0,a.jsx)("li",{children:"• Use a unique password for each account"}),(0,a.jsx)("li",{children:"• Consider using a password manager"})]})]})]})})}var K=t(9364),V=t(4951);function W(e){let{userId:s}=e,[t,r]=(0,i.useState)([]),[l,n]=(0,i.useState)([]),[d,c]=(0,i.useState)(!0),[o,x]=(0,i.useState)(null),[m,u]=(0,i.useState)(null),[h,g]=(0,i.useState)({title:"",description:"",expected_hours:1,price_in_hours:1,status:"active"});(0,i.useEffect)(()=>{(async function(){try{c(!0),x(null);let[e,{data:t}]=await Promise.all([(0,V.Be)(s),k.O.from("user_skills").select("*, skills(name)").eq("user_id",s).eq("willing_to_teach",!0)]);r(e||[]),n(t||[])}catch(e){x("Failed to load data: "+e.message)}finally{c(!1)}})()},[s]),(0,i.useEffect)(()=>(0,V.tt)(s,r),[s]);let{requests:b,updateStatus:p,isUpdating:f}=(0,K.q)({userId:s,asProvider:!0}),j=e=>{let{name:s,value:t}=e.target,a="expected_hours"===s||"price_in_hours"===s?parseFloat(t)||0:t;g(e=>({...e,[s]:a}))},y=async e=>{if(e.preventDefault(),!h.title||h.expected_hours&&h.expected_hours<=0||h.price_in_hours&&h.price_in_hours<=0){x("Please fill required fields with valid values.");return}let t={...h},a=null;try{m?(a=await (0,V.ub)(m,h))&&r(e=>e.map(e=>e.id===m?a:e)):(a=await (0,V.RS)(t,s))&&r(e=>[a,...e]),w(),x(null)}catch(e){x("Failed to save offering: "+e.message)}},N=async e=>{confirm("Are you sure you want to delete this offering?")&&(await (0,V.u6)(e)?r(s=>s.filter(s=>s.id!==e)):x("Failed to delete offering."))},v=e=>{u(e.id),g(e)},w=()=>{g({title:"",description:"",expected_hours:1,price_in_hours:1,status:"active"}),u(null)},_=async(e,s)=>{if(confirm("Are you sure? This will ".concat("accepted"===s?"accept and charge credits":"reject"," the request.")))try{await p({requestId:e,status:s}),x(null)}catch(e){x("Failed to update status: "+e.message)}};return d?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("form",{onSubmit:y,className:"bg-white p-6 rounded-lg shadow",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:m?"Edit Offering":"Create New Service Offering"}),o&&(0,a.jsx)("p",{className:"text-red-500 mb-4",children:o}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)("input",{type:"text",name:"title",placeholder:"Service Title",value:h.title||"",onChange:j,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0}),(0,a.jsxs)("select",{name:"skill_id",value:h.skill_id||"",onChange:j,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select a Skill"}),l.map(e=>{var s;return(0,a.jsx)("option",{value:e.skill_id,children:null===(s=e.skills)||void 0===s?void 0:s.name},e.id)})]}),(0,a.jsx)("textarea",{name:"description",placeholder:"Description",value:h.description||"",onChange:j,rows:3,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500 col-span-2"}),(0,a.jsx)("input",{type:"number",name:"expected_hours",placeholder:"Expected Duration (hours)",value:h.expected_hours||"",onChange:j,min:.5,step:.5,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0}),(0,a.jsx)("input",{type:"number",name:"price_in_hours",placeholder:"Price in Time Credits (hours)",value:h.price_in_hours||"",onChange:j,min:.5,step:.5,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0}),(0,a.jsxs)("select",{name:"status",value:h.status||"active",onChange:j,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"inactive",children:"Inactive"}),(0,a.jsx)("option",{value:"booked",children:"Booked"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:m?"Update":"Create"}),m&&(0,a.jsx)("button",{type:"button",onClick:w,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Cancel"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold p-4 border-b",children:["My Service Offerings (",t.length,")"]}),0===t.length?(0,a.jsx)("p",{className:"p-4 text-gray-500",children:"No offerings yet. Create one above!"}):(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:t.map(e=>{var s;return(0,a.jsxs)("li",{className:"p-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[null===(s=e.description)||void 0===s?void 0:s.substring(0,100),"... | ",e.expected_hours,"h | ",e.price_in_hours,"h credits"]}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"booked"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>v(e),className:"text-blue-500 hover:text-blue-700","aria-label":"Edit offering",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>N(e.id),className:"text-red-500 hover:text-red-700","aria-label":"Delete offering",children:"Delete"})]})]},e.id)})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold p-4 border-b",children:["Incoming Requests (",b.length,")"]}),0===b.length?(0,a.jsx)("p",{className:"p-4 text-gray-500",children:"No incoming requests yet."}):(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:b.map(e=>(0,a.jsx)("li",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h4",{className:"font-medium",children:['Request for "',e.service_offerings.title,'"']}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["From: ",e.users.username," | Hours: ",e.requested_hours," | ",e.notes||"No notes"]}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs rounded-full ".concat("pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status.toUpperCase()})]}),"pending"===e.status&&(0,a.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,a.jsx)("button",{onClick:()=>_(e.id,"accepted"),disabled:f,className:"px-3 py-1 bg-green-500 text-white text-sm rounded hover:bg-green-600 disabled:opacity-50",children:"Accept"}),(0,a.jsx)("button",{onClick:()=>_(e.id,"rejected"),disabled:f,className:"px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600 disabled:opacity-50",children:"Reject"})]})]})},e.id))})]})]})}var Y=t(9027),G=t(8202),X=t(3766),$=t(202),J=t(8551),ee=t(8029);async function es(e){try{let{data:s,error:t}=await k.O.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(t)throw Error("Failed to fetch notifications: ".concat(t.message));return s||[]}catch(e){return console.error("Notifications fetch error:",e),[]}}async function et(e){try{let{error:s}=await k.O.from("notifications").update({read:!0}).eq("id",e);if(s)throw Error("Failed to mark as read: ".concat(s.message));return!0}catch(e){return console.error("Mark as read error:",e),!1}}async function ea(e){try{let{data:s}=await k.O.from("notifications").select("id").eq("user_id",e).eq("read",!1);if(!s||0===s.length)return!0;let{error:t}=await k.O.from("notifications").update({read:!0}).in("id",s.map(e=>e.id));if(t)throw Error("Failed to mark all as read: ".concat(t.message));return!0}catch(e){return console.error("Mark all as read error:",e),!1}}let er=e=>{let{userId:s}=e,[t,r]=(0,i.useState)(!1),{notifications:l,unreadCount:n,isLoading:d,error:c,markAsRead:o,markAllAsRead:x,isMarking:m}=function(e){let s=(0,$.NL)(),{data:t=[],isLoading:a,error:r}=(0,J.a)({queryKey:["notifications",e],queryFn:()=>es(e),enabled:!!e,staleTime:3e5});(0,i.useEffect)(()=>{if(e)return function(e,s){let t=k.O.channel("user_notifications").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:"user_id=eq.".concat(e)},async()=>{s(await es(e))}).subscribe();return()=>k.O.removeChannel(t)}(e,t=>{s.setQueryData(["notifications",e],t)})},[e,s]);let l=(0,ee.D)({mutationFn:e=>et(e),onMutate:async t=>{await s.cancelQueries({queryKey:["notifications",e]});let a=s.getQueryData(["notifications",e]);return s.setQueryData(["notifications",e],e=>null==e?void 0:e.map(e=>e.id===t?{...e,read:!0}:e)),{previousNotifications:a}},onError:(t,a,r)=>{s.setQueryData(["notifications",e],null==r?void 0:r.previousNotifications),console.error("Failed to mark as read:",t)},onSettled:()=>{s.invalidateQueries({queryKey:["notifications",e]})}}),n=(0,ee.D)({mutationFn:()=>ea(e),onMutate:async()=>{await s.cancelQueries({queryKey:["notifications",e]});let t=s.getQueryData(["notifications",e]);return s.setQueryData(["notifications",e],e=>null==e?void 0:e.map(e=>({...e,read:!0}))),{previousNotifications:t}},onError:(t,a,r)=>{s.setQueryData(["notifications",e],null==r?void 0:r.previousNotifications),console.error("Failed to mark all as read:",t)},onSettled:()=>{s.invalidateQueries({queryKey:["notifications",e]})}}),d=t.filter(e=>!e.read).length;return{notifications:t,unreadCount:d,isLoading:a,error:r,markAsRead:l.mutateAsync,markAllAsRead:n.mutateAsync,isMarking:l.isPending||n.isPending}}(s),u=async e=>{e.read||await o(e.id),e.link&&window.open(e.link,"_blank"),r(!1)};return d?(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500","aria-label":"Loading notifications"})}):c?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700",onClick:()=>window.location.reload(),"aria-label":"Retry loading notifications",children:"\uD83D\uDD14"}),(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:"!"})]}):(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)(Y.v2,{as:"div",className:"relative inline-block text-left",children:[(0,a.jsxs)(Y.v2.Button,{className:"p-2 text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full",children:[(0,a.jsx)("span",{className:"sr-only",children:"Notifications"}),(0,a.jsx)("span",{"aria-label":"Notifications: ".concat(n," unread"),children:"\uD83D\uDD14"}),n>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center min-w-[20px] font-bold",children:n>99?"99+":n})]}),(0,a.jsx)(G.u,{show:t,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,a.jsxs)(Y.v2.Items,{static:!0,className:"absolute right-0 mt-2 w-80 max-h-96 overflow-y-auto origin-top-right bg-white divide-y divide-gray-100 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:[(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Notifications"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[n," unread"]}),n>0&&(0,a.jsx)("button",{onClick:async()=>{await x(),r(!1)},disabled:m,className:"text-xs text-blue-600 hover:text-blue-500 disabled:opacity-50 mt-1",children:"Mark all as read"})]}),(0,a.jsx)("div",{className:"py-1",children:0===l.length?(0,a.jsx)("p",{className:"px-4 py-3 text-sm text-gray-500",children:"No notifications yet."}):l.map(e=>(0,a.jsx)(Y.v2.Item,{children:s=>{let{active:t}=s;return(0,a.jsx)("button",{onClick:()=>u(e),className:"w-full text-left px-4 py-3 text-sm ".concat(t?"bg-gray-100":""," ").concat(e.read?"":"bg-blue-50 border-r-4 border-blue-500"),disabled:m,children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("span",{className:"inline-flex h-8 w-8 rounded-full ".concat("system"===e.type?"bg-gray-500":"transaction"===e.type?"bg-green-500":"service_request"===e.type?"bg-blue-500":"review"===e.type?"bg-yellow-500":"bg-purple-500"," text-white flex items-center justify-center text-xs font-medium"),children:e.type.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium ".concat(e.read?"text-gray-500":"text-gray-900"),children:e.title||"Notification"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:(0,X.Q)(new Date(e.created_at),{addSuffix:!0})})]}),!e.read&&(0,a.jsx)("div",{className:"flex-shrink-0 ml-2",children:(0,a.jsx)("span",{className:"text-xs text-blue-500",children:"New"})})]})})}},e.id))})]})})]})})};var el=t(6724),ei=t(3633),en=t(6111),ed=t(2542),ec=t(3432),eo=t(6127),ex=t(4270),em=t(7818),eu=t(3050),eh=t(7695),eg=t(4531),eb=t(2190);let ep={async depositCredits(e,s,t){let{data:{user:a}}=await k.O.auth.getUser();if(!a)throw Error("Not authenticated");let{data:r,error:l}=await k.O.rpc("admin_deposit_credits",{p_admin_id:a.id,p_user_id:e,p_amount:s,p_reason:t,p_ip_address:null});if(l)throw l;return r},async withdrawCredits(e,s,t){let{data:{user:a}}=await k.O.auth.getUser();if(!a)throw Error("Not authenticated");let{data:r,error:l}=await k.O.rpc("admin_withdraw_credits",{p_admin_id:a.id,p_user_id:e,p_amount:s,p_reason:t,p_ip_address:null});if(l)throw l;return r},async cancelTransaction(e,s){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:{user:a}}=await k.O.auth.getUser();if(!a)throw Error("Not authenticated");let{data:r,error:l}=await k.O.rpc("admin_cancel_transaction",{p_admin_id:a.id,p_transaction_id:e,p_reason:s,p_refund:t,p_ip_address:null});if(l)throw l;return r},async getSystemStats(){let{data:e,error:s}=await k.O.rpc("get_system_statistics");if(s)throw s;return e},async getAllUsers(e){let s=k.O.from("users").select("*").order("created_at",{ascending:!1});e&&(s=s.or("username.ilike.%".concat(e,"%,email.ilike.%").concat(e,"%")));let{data:t,error:a}=await s;if(a)throw a;return t},async getAllTransactions(e){let s=k.O.from("ledger").select("\n        *,\n        from_user_details:users!ledger_from_user_fkey(username, email, avatar_url),\n        to_user_details:users!ledger_to_user_fkey(username, email, avatar_url),\n        skill:skills(name)\n      ").order("created_at",{ascending:!1}).limit(100),{data:t,error:a}=await s;if(a)throw a;return t},async getActionLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,{data:s,error:t}=await k.O.from("admin_action_logs").select("\n        *,\n        admin:users!admin_action_logs_admin_user_id_fkey(username, email),\n        target_user:users!admin_action_logs_target_user_id_fkey(username, email)\n      ").order("created_at",{ascending:!1}).limit(e);if(t)throw t;return s},async updateUserStatus(e,s,t){let{data:{user:a}}=await k.O.auth.getUser();if(!a)throw Error("Not authenticated");let{data:r,error:l}=await k.O.from("users").update({is_active:s,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(l)throw l;let{error:i}=await k.O.from("admin_action_logs").insert({admin_user_id:a.id,action_type:s?"user_activate":"user_suspend",target_user_id:e,reason:t});if(i)throw i;return r},async updateUserRole(e,s,t){let{data:{user:a}}=await k.O.auth.getUser();if(!a)throw Error("Not authenticated");let{data:r,error:l}=await k.O.from("users").update({role:s,is_admin:"admin"===s,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(l)throw l;let{error:i}=await k.O.from("admin_action_logs").insert({admin_user_id:a.id,action_type:"role_change",target_user_id:e,reason:t,metadata:{new_role:s}});if(i)throw i;return r}};function ef(){var e,s;let[t,r]=(0,i.useState)("overview"),[l,x]=(0,i.useState)([]),[m,h]=(0,i.useState)([]),[g,b]=(0,i.useState)(null),[p,j]=(0,i.useState)([]),[y,N]=(0,i.useState)(!0),[v,w]=(0,i.useState)(""),[_,k]=(0,i.useState)(null),[S,Z]=(0,i.useState)(null),[A,D]=(0,i.useState)(!1),[O,F]=(0,i.useState)(!1),[E,q]=(0,i.useState)(!1),[T,U]=(0,i.useState)(null),[P,L]=(0,i.useState)({amount:"",reason:""}),[R,M]=(0,i.useState)({amount:"",reason:""}),[I,B]=(0,i.useState)(!1);(0,i.useEffect)(()=>{z()},[t]);let z=async()=>{N(!0),k(null);try{if("overview"===t){let e=await ep.getSystemStats();b(e)}else if("users"===t){let e=await ep.getAllUsers(v);x(e||[])}else if("transactions"===t){let e=await ep.getAllTransactions();h(e||[])}else if("logs"===t){let e=await ep.getActionLogs();j(e||[])}}catch(e){console.error("Error loading data:",e),k(e.message||"Failed to load data")}finally{N(!1)}},Q=async()=>{if(S&&P.amount&&P.reason){B(!0);try{await ep.depositCredits(S.id,parseFloat(P.amount),P.reason),alert("Successfully deposited ".concat(P.amount," hours to ").concat(S.username)),D(!1),L({amount:"",reason:""}),z()}catch(e){console.error("Deposit error:",e),alert("Failed to deposit credits: "+e.message)}finally{B(!1)}}},H=async()=>{if(S&&R.amount&&R.reason){B(!0);try{await ep.withdrawCredits(S.id,parseFloat(R.amount),R.reason),alert("Successfully withdrew ".concat(R.amount," hours from ").concat(S.username)),F(!1),M({amount:"",reason:""}),z()}catch(e){console.error("Withdraw error:",e),alert("Failed to withdraw credits: "+e.message)}finally{B(!1)}}},K=async()=>{if(T){B(!0);try{await ep.cancelTransaction(T.id,"Admin cancelled transaction",!0),alert("Successfully cancelled transaction"),q(!1),z()}catch(e){console.error("Cancel error:",e),alert("Failed to cancel transaction: "+e.message)}finally{B(!1)}}},V=()=>{z()},W=l.filter(e=>e.username.toLowerCase().includes(v.toLowerCase())||e.email.toLowerCase().includes(v.toLowerCase())),Y=m.filter(e=>{var s,t;let a=(null===(s=e.from_user_details)||void 0===s?void 0:s.username)||"",r=(null===(t=e.to_user_details)||void 0===t?void 0:t.username)||"",l=e.note||"",i=v.toLowerCase();return a.toLowerCase().includes(i)||r.toLowerCase().includes(i)||l.toLowerCase().includes(i)});return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-blue-50",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-red-600 via-orange-600 to-amber-600 text-white shadow-xl",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-white/20 backdrop-blur rounded-2xl flex items-center justify-center",children:(0,a.jsx)(f.Z,{className:"w-9 h-9 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-black",children:"Admin Control Panel"}),(0,a.jsx)("p",{className:"text-red-100 text-sm mt-1",children:"System Management & Bank Operations"})]})]}),(0,a.jsxs)("button",{onClick:z,disabled:y,className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-xl transition-colors disabled:opacity-50",children:[(0,a.jsx)(C.Z,{className:"w-4 h-4 ".concat(y?"animate-spin":"")}),(0,a.jsx)("span",{className:"text-sm font-semibold",children:"Refresh"})]})]}),(0,a.jsx)("nav",{className:"flex gap-2 mt-6 overflow-x-auto pb-2",children:[{key:"overview",label:"Overview",icon:ei.Z},{key:"users",label:"Users",icon:u.Z},{key:"transactions",label:"Transactions",icon:o.Z},{key:"bank",label:"Bank Operations",icon:en.Z},{key:"logs",label:"Action Logs",icon:n.Z}].map(e=>{let{key:s,label:l,icon:i}=e;return(0,a.jsxs)("button",{onClick:()=>r(s),className:"flex items-center gap-2 px-5 py-3 rounded-xl font-semibold text-sm transition-all whitespace-nowrap ".concat(t===s?"bg-white text-red-600 shadow-lg":"bg-white/10 text-white hover:bg-white/20"),children:[(0,a.jsx)(i,{className:"w-4 h-4"}),l]},s)})})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[_&&(0,a.jsxs)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-3",children:[(0,a.jsx)(ed.Z,{className:"w-5 h-5 text-red-600"}),(0,a.jsx)("p",{className:"text-red-800",children:_})]}),y&&(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(ec.Z,{className:"w-8 h-8 text-blue-600 animate-spin"})}),!y&&(0,a.jsxs)(a.Fragment,{children:["overview"===t&&g&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-6 h-6 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Users"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(null===(e=g.total_users)||void 0===e?void 0:e.toLocaleString())||0})]})]}),(0,a.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,a.jsx)(c.Z,{className:"w-3 h-3"}),g.active_users||0," active"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(o.Z,{className:"w-6 h-6 text-emerald-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Transactions"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(null===(s=g.total_transactions)||void 0===s?void 0:s.toLocaleString())||0})]})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:[g.completed_transactions||0," completed"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(n.Z,{className:"w-6 h-6 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Hours Circulated"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:parseFloat(g.total_hours_circulated||0).toLocaleString()})]})]}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Total exchanged"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-red-500 to-orange-600 rounded-xl p-6 text-white shadow-lg hover:shadow-xl transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center",children:(0,a.jsx)(ed.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-red-100",children:"Pending"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-white",children:g.pending_transactions||0})]})]}),(0,a.jsx)("p",{className:"text-xs text-red-100",children:"Requires attention"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-8",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-6 h-6 text-blue-600"}),"System Balance Overview"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"p-6 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-200",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Total System Balance"}),(0,a.jsx)("p",{className:"text-4xl font-bold text-gray-900 mb-1",children:parseFloat(g.total_system_balance||0).toFixed(2)}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"hours in circulation"})]}),(0,a.jsxs)("div",{className:"p-6 bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-200",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Average User Balance"}),(0,a.jsx)("p",{className:"text-4xl font-bold text-gray-900 mb-1",children:parseFloat(g.avg_user_balance||0).toFixed(2)}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"hours per active user"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Service Offerings"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:g.total_service_offerings||0}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[g.active_service_offerings||0," active"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Verified Users"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:g.verified_users||0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"ID verified members"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Average Rating"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:parseFloat(g.avg_user_rating||0).toFixed(2)}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Community score"})]})]})]}),"users"===t&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(eo.Z,{className:"w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search users by username or email...",value:v,onChange:e=>w(e.target.value),onKeyDown:e=>"Enter"===e.key&&V(),className:"flex-1 outline-none text-gray-900"}),(0,a.jsx)("button",{onClick:V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-semibold",children:"Search"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"User"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Balance"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===W.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"No users found"})}):W.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center text-white font-bold",children:e.username.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:e.username}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.role})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.email}),(0,a.jsxs)("td",{className:"px-6 py-4",children:[(0,a.jsx)("span",{className:"font-bold text-gray-900",children:e.time_balance}),(0,a.jsx)("span",{className:"text-sm text-gray-600 ml-1",children:"hrs"})]}),(0,a.jsx)("td",{className:"px-6 py-4",children:e.is_active?(0,a.jsx)("span",{className:"px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-full",children:"Active"}):(0,a.jsx)("span",{className:"px-3 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded-full",children:"Inactive"})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>{Z(e),D(!0)},className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Deposit",children:(0,a.jsx)(ex.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{Z(e),F(!0)},className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Withdraw",children:(0,a.jsx)(em.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})})})]}),"transactions"===t&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(eo.Z,{className:"w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search transactions...",value:v,onChange:e=>w(e.target.value),className:"flex-1 outline-none text-gray-900"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"ID"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"From"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"To"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Hours"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Type"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===Y.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"No transactions found"})}):Y.map(e=>{var s,t;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsxs)("td",{className:"px-6 py-4 text-sm font-mono text-gray-600",children:[e.id.substring(0,8),"..."]}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:(null===(s=e.from_user_details)||void 0===s?void 0:s.username)||"Unknown"}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:(null===(t=e.to_user_details)||void 0===t?void 0:t.username)||"Unknown"}),(0,a.jsxs)("td",{className:"px-6 py-4",children:[(0,a.jsx)("span",{className:"font-bold text-gray-900",children:e.hours}),(0,a.jsx)("span",{className:"text-sm text-gray-600 ml-1",children:"hrs"})]}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded",children:e.transaction_type})}),(0,a.jsxs)("td",{className:"px-6 py-4",children:["completed"===e.status&&(0,a.jsxs)("span",{className:"px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-full flex items-center gap-1 w-fit",children:[(0,a.jsx)(eu.Z,{className:"w-3 h-3"}),"Completed"]}),"pending"===e.status&&(0,a.jsxs)("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 text-xs font-semibold rounded-full flex items-center gap-1 w-fit",children:[(0,a.jsx)(n.Z,{className:"w-3 h-3"}),"Pending"]}),"disputed"===e.status&&(0,a.jsxs)("span",{className:"px-3 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded-full flex items-center gap-1 w-fit",children:[(0,a.jsx)(ed.Z,{className:"w-3 h-3"}),"Disputed"]}),"cancelled"===e.status&&(0,a.jsxs)("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 text-xs font-semibold rounded-full flex items-center gap-1 w-fit",children:[(0,a.jsx)(eh.Z,{className:"w-3 h-3"}),"Cancelled"]})]}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4",children:"cancelled"!==e.status&&(0,a.jsx)("button",{onClick:()=>{U(e),q(!0)},className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Cancel Transaction",children:(0,a.jsx)(eh.Z,{className:"w-4 h-4"})})})]},e.id)})})]})})})]}),"bank"===t&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border-2 border-green-200 p-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(eg.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Deposit Credits"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Add time to user accounts"})]})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"Select a user from the Users tab to deposit time credits. All deposits are logged and audited."}),(0,a.jsx)("button",{onClick:()=>r("users"),className:"w-full bg-green-600 text-white font-semibold py-3 rounded-xl hover:bg-green-700 transition-colors",children:"Go to Users"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 rounded-xl border-2 border-red-200 p-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-red-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Withdraw Credits"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Remove time from user accounts"})]})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"Select a user from the Users tab to withdraw time credits. Requires sufficient balance and reason."}),(0,a.jsx)("button",{onClick:()=>r("users"),className:"w-full bg-red-600 text-white font-semibold py-3 rounded-xl hover:bg-red-700 transition-colors",children:"Go to Users"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(o.Z,{className:"w-6 h-6 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Transaction Management"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Cancel or modify transactions"})]})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"View and manage all transactions in the system. Cancel disputed transactions or apply refunds."}),(0,a.jsx)("button",{onClick:()=>r("transactions"),className:"bg-blue-600 text-white font-semibold px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors",children:"View All Transactions"})]})]}),"logs"===t&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Admin Action Logs"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Complete audit trail of all administrative actions"})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Admin"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Action"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Target User"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase",children:"Reason"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===p.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"No action logs found"})}):p.map(e=>{var s,t;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(e.created_at).toLocaleString()}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:(null===(s=e.admin)||void 0===s?void 0:s.username)||"Unknown"}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded",children:e.action_type})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:(null===(t=e.target_user)||void 0===t?void 0:t.username)||"N/A"}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.amount?"".concat(e.amount," hrs"):"-"}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600 max-w-xs truncate",children:e.reason})]},e.id)})})]})})]})})]})]}),A&&S&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-md w-full p-8 shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(ex.Z,{className:"w-6 h-6 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Deposit Credits"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Add time to ",S.username]})]})]}),(0,a.jsx)("button",{onClick:()=>D(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(eb.Z,{className:"w-5 h-5 text-gray-500"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Amount (hours)"}),(0,a.jsx)("input",{type:"number",step:"0.5",min:"0",value:P.amount,onChange:e=>L({...P,amount:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none",placeholder:"Enter hours to deposit"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Reason (required)"}),(0,a.jsx)("textarea",{value:P.reason,onChange:e=>L({...P,reason:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none resize-none",rows:3,placeholder:"Explain why you're depositing credits..."})]}),(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:(0,a.jsxs)("p",{className:"text-sm text-green-800",children:[(0,a.jsx)("strong",{children:"Current Balance:"})," ",S.time_balance," hours",(0,a.jsx)("br",{}),(0,a.jsx)("strong",{children:"New Balance:"})," ",(parseFloat(S.time_balance.toString())+parseFloat(P.amount||"0")).toFixed(2)," hours"]})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>D(!1),disabled:I,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 font-semibold rounded-xl hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:Q,disabled:!P.amount||!P.reason||I,className:"flex-1 px-6 py-3 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec.Z,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):"Deposit Credits"})]})]})]})}),O&&S&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-md w-full p-8 shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(em.Z,{className:"w-6 h-6 text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Withdraw Credits"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Remove time from ",S.username]})]})]}),(0,a.jsx)("button",{onClick:()=>F(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(eb.Z,{className:"w-5 h-5 text-gray-500"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Amount (hours)"}),(0,a.jsx)("input",{type:"number",step:"0.5",min:"0",max:S.time_balance,value:R.amount,onChange:e=>M({...R,amount:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none",placeholder:"Enter hours to withdraw"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Reason (required)"}),(0,a.jsx)("textarea",{value:R.reason,onChange:e=>M({...R,reason:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none resize-none",rows:3,placeholder:"Explain why you're withdrawing credits..."})]}),(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:(0,a.jsxs)("p",{className:"text-sm text-red-800",children:[(0,a.jsx)("strong",{children:"Current Balance:"})," ",S.time_balance," hours",(0,a.jsx)("br",{}),(0,a.jsx)("strong",{children:"New Balance:"})," ",(parseFloat(S.time_balance.toString())-parseFloat(R.amount||"0")).toFixed(2)," hours"]})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>F(!1),disabled:I,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 font-semibold rounded-xl hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:H,disabled:!R.amount||!R.reason||parseFloat(R.amount)>S.time_balance||I,className:"flex-1 px-6 py-3 bg-red-600 text-white font-semibold rounded-xl hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec.Z,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):"Withdraw Credits"})]})]})]})}),E&&T&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-md w-full p-8 shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(ed.Z,{className:"w-6 h-6 text-orange-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Cancel Transaction"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["ID: ",T.id.substring(0,8),"..."]})]})]}),(0,a.jsx)("button",{onClick:()=>q(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(eb.Z,{className:"w-5 h-5 text-gray-500"})})]}),(0,a.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 mb-6",children:[(0,a.jsx)("p",{className:"text-sm text-orange-800 font-medium",children:"Are you sure you want to cancel this transaction? This action will:"}),(0,a.jsxs)("ul",{className:"mt-2 space-y-1 text-sm text-orange-700 ml-4",children:[(0,a.jsxs)("li",{children:["• Reverse ",T.hours," hours"]}),(0,a.jsx)("li",{children:"• Notify both users"}),(0,a.jsx)("li",{children:"• Create an audit log entry"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>q(!1),disabled:I,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 font-semibold rounded-xl hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Keep Transaction"}),(0,a.jsx)("button",{onClick:K,disabled:I,className:"flex-1 px-6 py-3 bg-red-600 text-white font-semibold rounded-xl hover:bg-red-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec.Z,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):"Cancel Transaction"})]})]})})]})}function ej(e){let{user:s,onSignOut:t}=e,{activeTab:r,setActiveTab:v}=function(e){let[s,t]=(0,i.useState)(e);return{activeTab:s,setActiveTab:t}}("overview"),[w,_]=(0,i.useState)(!1),k=(0,i.useMemo)(()=>{switch(r){case"overview":return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-5 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 group",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsx)("div",{className:"w-11 h-11 bg-blue-50 rounded-lg flex items-center justify-center group-hover:bg-blue-100 transition-colors",children:(0,a.jsx)(n.Z,{className:"w-6 h-6 text-blue-600"})}),(0,a.jsx)("span",{className:"text-xs font-semibold text-green-600 bg-green-50 px-2 py-1 rounded-full",children:"Active"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 font-medium mb-1",children:"Time Balance"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Check Balance"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"See your available hours"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-5 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 group",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsx)("div",{className:"w-11 h-11 bg-emerald-50 rounded-lg flex items-center justify-center group-hover:bg-emerald-100 transition-colors",children:(0,a.jsx)(d.Z,{className:"w-6 h-6 text-emerald-600"})}),(0,a.jsx)(c.Z,{className:"w-4 h-4 text-emerald-600"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 font-medium mb-1",children:"Services Offered"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Manage"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Your service catalog"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-5 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 group",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsx)("div",{className:"w-11 h-11 bg-purple-50 rounded-lg flex items-center justify-center group-hover:bg-purple-100 transition-colors",children:(0,a.jsx)(o.Z,{className:"w-6 h-6 text-purple-600"})}),(0,a.jsx)("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2 py-1 rounded-full",children:"Live"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 font-medium mb-1",children:"Recent Activity"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mb-1",children:"View All"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Latest transactions"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl p-5 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 group cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsx)("div",{className:"w-11 h-11 bg-white/20 backdrop-blur rounded-lg flex items-center justify-center group-hover:bg-white/30 transition-colors",children:(0,a.jsx)(x.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsx)(m.Z,{className:"w-5 h-5 text-yellow-300"})]}),(0,a.jsx)("p",{className:"text-sm text-blue-100 font-medium mb-1",children:"Marketplace"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-white mb-1",children:"Explore"}),(0,a.jsx)("p",{className:"text-xs text-blue-200",children:"Find services now"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"xl:col-span-2 space-y-6",children:[(0,a.jsxs)("section",{"aria-labelledby":"balance-heading",className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl blur-xl opacity-20"}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(Z,{userId:s.id})})]}),(0,a.jsxs)("section",{"aria-labelledby":"transactions-heading",className:"bg-white rounded-2xl border border-gray-200 overflow-hidden hover:shadow-xl transition-shadow duration-300",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 px-6 py-5",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-sm",children:(0,a.jsx)(o.Z,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{id:"transactions-heading",className:"text-lg font-bold text-gray-900",children:"Recent Activity"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Your latest time exchanges"})]})]}),(0,a.jsxs)("button",{onClick:()=>v("transactions"),className:"text-sm font-semibold text-blue-600 hover:text-blue-700 flex items-center gap-1 transition-colors group",children:["View All",(0,a.jsx)(c.Z,{className:"w-4 h-4 group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-transform"})]})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(D,{userId:s.id})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("section",{"aria-labelledby":"transfer-heading",className:"relative group",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-400 to-purple-500 rounded-2xl blur-lg opacity-0 group-hover:opacity-30 transition-opacity duration-500"}),(0,a.jsxs)("div",{className:"relative bg-white rounded-2xl border-2 border-gray-200 overflow-hidden hover:border-blue-300 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-5 py-4 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-sm",children:(0,a.jsx)(m.Z,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("h3",{className:"text-base font-bold text-gray-900",children:"Quick Transfer"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Send time in seconds"})]}),(0,a.jsx)("div",{className:"p-5",children:(0,a.jsx)(A,{userId:s.id})})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 rounded-2xl border border-blue-100 p-6 hover:shadow-lg transition-shadow duration-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-5",children:[(0,a.jsx)("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-sm",children:(0,a.jsx)(u.Z,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-900",children:"Community Pulse"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Live marketplace stats"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/80 backdrop-blur rounded-xl border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-4 h-4 text-emerald-600"})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Active Members"})]}),(0,a.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"1.2K+"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/80 backdrop-blur rounded-xl border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(n.Z,{className:"w-4 h-4 text-blue-600"})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Hours Traded"})]}),(0,a.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"5.6K"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/80 backdrop-blur rounded-xl border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(h.Z,{className:"w-4 h-4 text-purple-600"})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Avg. Rating"})]}),(0,a.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"4.8"})]})]}),(0,a.jsxs)("button",{onClick:()=>v("marketplace"),className:"w-full mt-5 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold py-3 rounded-xl transition-all duration-300 shadow-sm hover:shadow-md flex items-center justify-center gap-2 group",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Explore Marketplace",(0,a.jsx)(c.Z,{className:"w-4 h-4 group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-transform"})]})]})]})]})]});case"profile":return(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 px-8 py-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 bg-white/20 backdrop-blur rounded-2xl flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Your Profile"}),(0,a.jsx)("p",{className:"text-blue-100 text-sm",children:"Manage your personal information"})]})]})}),(0,a.jsx)("section",{className:"p-8","aria-labelledby":"profile-heading",children:(0,a.jsx)(L,{userId:s.id})})]})});case"skills":return(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 px-8 py-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 bg-white/20 backdrop-blur rounded-2xl flex items-center justify-center",children:(0,a.jsx)(g.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Skills & Expertise"}),(0,a.jsx)("p",{className:"text-purple-100 text-sm",children:"Showcase your talents to the community"})]})]})}),(0,a.jsx)("section",{className:"p-8","aria-labelledby":"skills-heading",children:(0,a.jsx)(T,{userId:s.id})})]})});case"transactions":return(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 px-8 py-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 bg-white/20 backdrop-blur rounded-2xl flex items-center justify-center",children:(0,a.jsx)(b.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{id:"all-transactions-heading",className:"text-2xl font-bold text-white",children:"Transaction History"}),(0,a.jsx)("p",{className:"text-emerald-100 text-sm",children:"Complete record of all time exchanges"})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-emerald-100 text-xs",children:"Total Volume"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-white",children:"View Stats"})]})]})}),(0,a.jsx)("section",{className:"p-8","aria-labelledby":"all-transactions-heading",children:(0,a.jsx)(D,{userId:s.id})})]})});case"services":return(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 to-blue-700 px-8 py-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 bg-white/20 backdrop-blur rounded-2xl flex items-center justify-center",children:(0,a.jsx)(p.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Service Management"}),(0,a.jsx)("p",{className:"text-indigo-100 text-sm",children:"Create and manage your service offerings"})]})]})}),(0,a.jsx)("section",{className:"p-8","aria-labelledby":"services-heading",children:(0,a.jsx)(W,{userId:s.id})})]})});case"marketplace":return(0,a.jsx)("section",{className:"w-full","aria-labelledby":"marketplace-heading",children:(0,a.jsx)(el.default,{})});case"security":return(0,a.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-red-600 to-orange-600 px-8 py-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 bg-white/20 backdrop-blur rounded-2xl flex items-center justify-center",children:(0,a.jsx)(f.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Security Settings"}),(0,a.jsx)("p",{className:"text-red-100 text-sm",children:"Protect your account and data"})]})]})}),(0,a.jsx)("section",{className:"p-8","aria-labelledby":"security-heading",children:(0,a.jsx)(H,{})})]})});case"admin":return s.is_admin?(0,a.jsx)("section",{className:"w-full","aria-labelledby":"admin-heading",children:(0,a.jsx)(ef,{})}):null;default:return null}},[r,s.id,v,s.is_admin]),C=[{key:"overview",label:"Overview",icon:n.Z,color:"blue"},{key:"marketplace",label:"Marketplace",icon:x.Z,color:"indigo"},{key:"services",label:"My Services",icon:p.Z,color:"purple"},{key:"skills",label:"Skills",icon:g.Z,color:"pink"},{key:"transactions",label:"History",icon:b.Z,color:"emerald"},{key:"profile",label:"Profile",icon:u.Z,color:"cyan"},{key:"security",label:"Security",icon:f.Z,color:"red"},...s.is_admin?[{key:"admin",label:"Admin",icon:j.Z,color:"orange"}]:[]];return(0,a.jsxs)("div",{className:"jsx-83037452c623c470 min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/50 to-indigo-50/30",children:[(0,a.jsx)("div",{className:"jsx-83037452c623c470 sticky top-0 z-50 backdrop-blur-xl bg-white/80 border-b border-gray-200 shadow-sm",children:(0,a.jsxs)("div",{className:"jsx-83037452c623c470 container mx-auto px-4 sm:px-6 lg:px-8 max-w-[1600px]",children:[(0,a.jsx)("header",{className:"jsx-83037452c623c470 py-4",children:(0,a.jsxs)("div",{className:"jsx-83037452c623c470 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"jsx-83037452c623c470 flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"jsx-83037452c623c470 relative group",children:[(0,a.jsx)("div",{className:"jsx-83037452c623c470 absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl blur-lg opacity-50 group-hover:opacity-75 transition-opacity"}),(0,a.jsx)("div",{className:"jsx-83037452c623c470 relative w-12 h-12 bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 rounded-2xl flex items-center justify-center shadow-xl",children:(0,a.jsx)(n.Z,{className:"w-7 h-7 text-white"})})]}),(0,a.jsxs)("div",{className:"jsx-83037452c623c470",children:[(0,a.jsx)("h1",{className:"jsx-83037452c623c470 text-2xl font-black bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"TimeSwap"}),(0,a.jsx)("p",{className:"jsx-83037452c623c470 text-xs text-gray-600 font-medium",children:"Time-Based Service Exchange"})]})]}),(0,a.jsxs)("div",{className:"jsx-83037452c623c470 flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"jsx-83037452c623c470 relative",children:[(0,a.jsxs)("button",{onClick:()=>_(!w),className:"jsx-83037452c623c470 hidden md:flex items-center gap-3 px-4 py-2 bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl border border-gray-200 hover:shadow-md transition-all",children:[(0,a.jsx)("div",{className:"jsx-83037452c623c470 w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center text-white font-bold text-sm",children:s.username.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{className:"jsx-83037452c623c470 text-left",children:[(0,a.jsx)("p",{className:"jsx-83037452c623c470 text-sm font-bold text-gray-900",children:s.username}),(0,a.jsx)("p",{className:"jsx-83037452c623c470 text-xs text-gray-600",children:s.is_admin?"Admin":"Member"})]}),(0,a.jsx)(y.Z,{className:"w-4 h-4 text-gray-600 transition-transform ".concat(w?"rotate-180":"")})]}),w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{onClick:()=>_(!1),className:"jsx-83037452c623c470 fixed inset-0 z-40"}),(0,a.jsxs)("div",{className:"jsx-83037452c623c470 absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-xl border border-gray-200 py-2 z-50",children:[(0,a.jsxs)("div",{className:"jsx-83037452c623c470 px-4 py-3 border-b border-gray-100",children:[(0,a.jsx)("p",{className:"jsx-83037452c623c470 text-sm font-bold text-gray-900",children:s.username}),(0,a.jsx)("p",{className:"jsx-83037452c623c470 text-xs text-gray-600",children:s.email})]}),(0,a.jsxs)("button",{onClick:()=>{_(!1),t()},className:"jsx-83037452c623c470 w-full px-4 py-3 text-left flex items-center gap-3 hover:bg-red-50 transition-colors text-red-600 font-medium",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4"}),"Sign Out"]})]})]})]}),(0,a.jsx)(er,{userId:s.id})]})]})}),(0,a.jsx)("nav",{role:"tablist","aria-label":"Dashboard tabs",className:"jsx-83037452c623c470 pb-0 -mb-px",children:(0,a.jsx)("div",{role:"tablist",className:"jsx-83037452c623c470 flex gap-1 overflow-x-auto scrollbar-hide",children:C.map(e=>{let{key:s,label:t,icon:l}=e;return(0,a.jsxs)("button",{onClick:()=>v(s),role:"tab","aria-selected":r===s,"aria-controls":"tabpanel-".concat(s),id:"tab-".concat(s),className:"jsx-83037452c623c470 "+"\n                    relative px-5 py-3 font-semibold text-sm transition-all whitespace-nowrap\n                    focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-t-xl\n                    flex items-center gap-2\n                    ".concat(r===s?"text-blue-600 bg-white border-t-2 border-x-2 border-blue-600 -mb-[2px]":"text-gray-600 hover:text-gray-900 hover:bg-gray-50/50","\n                  "),children:[(0,a.jsx)(l,{className:"jsx-83037452c623c470 w-4 h-4"}),(0,a.jsx)("span",{className:"jsx-83037452c623c470 hidden sm:inline",children:t}),r===s&&(0,a.jsx)("div",{className:"jsx-83037452c623c470 absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-600 to-indigo-600"})]},s)})})})]})}),(0,a.jsx)("div",{className:"jsx-83037452c623c470 container mx-auto px-4 sm:px-6 lg:px-8 py-8 max-w-[1600px]",children:(0,a.jsx)("main",{role:"tabpanel",id:"tabpanel-".concat(r),"aria-labelledby":"tab-".concat(r),className:"jsx-83037452c623c470",children:k})}),(0,a.jsx)(l(),{id:"83037452c623c470",children:".scrollbar-hide.jsx-83037452c623c470::-webkit-scrollbar{display:none}.scrollbar-hide.jsx-83037452c623c470{-ms-overflow-style:none;scrollbar-width:none}"})]})}function ey(){let{user:e,loading:s,logout:t}=(0,v.a)(),r=async()=>{try{await t(),window.location.href="/"}catch(e){console.error("Sign out error:",e)}};return s?(0,a.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/50 to-indigo-50/30","aria-label":"Loading dashboard",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"relative w-20 h-20 mx-auto mb-8",children:[(0,a.jsx)("div",{className:"absolute inset-0 border-4 border-blue-100 rounded-full"}),(0,a.jsx)("div",{className:"absolute inset-0 border-4 border-blue-600 rounded-full animate-spin border-t-transparent",role:"status"}),(0,a.jsx)("div",{className:"absolute inset-3 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-full flex items-center justify-center",children:(0,a.jsx)(n.Z,{className:"w-8 h-8 text-white animate-pulse"})})]}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Loading TimeSwap"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Preparing your dashboard..."}),(0,a.jsx)("p",{className:"sr-only",children:"Loading..."})]})}):(0,a.jsx)(_,{children:e?(0,a.jsx)(ej,{user:e,onSignOut:r}):null})}}},function(e){e.O(0,[342,543,83,412,724,888,774,179],function(){return e(e.s=6117)}),_N_E=e.O()}]);